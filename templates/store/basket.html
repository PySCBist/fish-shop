{% extends 'base.html' %}
{% load static %}
{% block title %}Корзина{% endblock %}
{% load thumbnail %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="box-element">
      <a class="btn btn-outline-dark" href="{% url 'index' %}">&#x2190; На главную</a>

      <br>
      <br>

      <table class="table">
        <tr>
        <th><h5>Общее кол-во: <strong id="total-items">{{ order.get_total_items }}</strong> шт.</h5></th>
        <th>
          {% if order.get_total_items > 0 and order.delivery_date %}
            <a style="float: right; margin:5px" class="btn btn-success make-order" href="#">Заказать</a>
          {% endif %}
        </th>
        </tr>
      </table>
	<div>
		<h5><strong>Дата доставки: </strong>
		  {% if order.delivery_date %}
		  	{{ order.delivery_date }}</h5>
		  {% else %}Нет доступной даты доставки</h5>
		   <th>Вы сможете сделать заказ, когда появится новая дата доставки.</th>
		  {% endif %}

        <h5><strong>Адрес доставки:</strong> {{ order.address }}</h5>
      </div>
    </div>

    <br>

    <div class="box-element">
    <div class="cart-row">
      <div style="flex: 2"></div>
      <div style="flex: 2"><strong>Наименование</strong></div>
      <div style="flex: 2"><strong>Описание</strong></div>
      <div style="flex: 1"><strong>Цена</strong></div>
      <div style="flex: 1"><strong>Кол-во (шт.)</strong></div>
    </div>
    {% for item in items %}
    <div class="cart-row">
      {% thumbnail item.product.image "974x730" crop="center" upscale=True as im %}
      <div style="flex: 2; display: inline-block"><img class="row-image" src="{{ im.url }}" alt="product"></div>
      {% endthumbnail %}
      <div style="flex: 2"><p>{{ item.product }}</p></div>
      <div style="flex: 2"><p>{{ item.product.description }}</p></div>
      <div style="flex: 1"><p>{{ item.product.price|floatformat:0 }} р. / кг.</p></div>
      <div style="flex:1">
        <p class="quantity" id="item-quantity{{ item.product.id }}">{{ item.quantity }}</p>
        <div class="quantity">
          <img data-product={{ item.product.id }} data-action="add" class="chg-quantity update-cart" src="{% static  'store/img/arrow-up.png' %}" alt="arrow-up">
          <img data-product={{ item.product.id }} data-action="remove" class="chg-quantity update-cart" src="{% static  'store/img/arrow-down.png' %}" alt="arrow-down">
        </div>
      </div>
    </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}

{% block script %}
  <script type="text/javascript" src="{% static 'store/js/makeOrder.js' %}"></script>
  <script type="text/javascript" src="{% static 'store/js/cart.js' %}"></script>
{% endblock script %}